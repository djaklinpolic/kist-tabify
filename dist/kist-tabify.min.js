/*! kist-tabify 0.1.3 - Simple tabs and accordion interface. | Author: Ivan NikoliÄ‡, 2014 | License: MIT */
!function(a,b,c,d){function e(a){return a.href&&"-pane"===a.ns&&(a.id=k(a.href)),a.id?a.id:s.ns.css+a.ns+"-"+a.instanceId+"-"+a.index}function f(b){var c,d=this.instance.id;return c="tab"===b?["aria-controls","pane"]:["aria-labelledby","tab"],function(f){var g,h,i=a(this),j=i.attr("id"),k=i.attr("href"),l={id:j,href:k,instanceId:d,index:f};g=e(a.extend({},l,{ns:s.classes[b]})),h=e(a.extend({},l,{ns:s.classes[c[1]]})),i.attr("id",g),i.attr(c[0],h)}}function g(a){var b=0;"next"===a&&(b=this.current===this.dom.tab.length-1||"number"!=typeof this.current?0:this.current+1),"prev"===a&&(b=0===this.current||"number"!=typeof this.current?this.dom.tab.length-1:this.current-1),this.select(b)}function h(b,c,d){var e=a(d);return e.attr("id")===b||e.data("tab-id")===b}function i(b,c,d){var e=a(d);return h.apply(null,arguments)||e.attr("href")==="#"+b}function j(a,b){return a.hasClass(this.options.classes.isActive)||b.hasClass(this.options.classes.isActive)?!0:!1}function k(a){return a.replace(/^#/,"")}function l(b,c){this.element=b,this.options=a.extend({},this.defaults,c),s.constructClasses.call(this),v.setup.call(this),t.setup.call(this),u.setup.call(this),this.dom.tab.is("a, button")||(this.destroy(),s.error("Tab items should only be anchors or button elements.")),this.move(this.options.initial)}function m(){m._super.constructor.apply(this,arguments)}function n(){}function o(){o._super.constructor.apply(this,arguments)}function p(){}function q(a){return"object"==typeof a?a:{}}function r(a){return"accordion"===a.type?o:m}var s={name:"tabify",ns:{css:"kist-Tabify",event:".kist.tabify"},error:function(a){throw new Error(s.name+": "+a)},constructClasses:function(){this.options.classes={},this.options.classesNs={},a.each(s.classes,a.proxy(function(b,c){var d=a.trim(this.options.namespace),e=s.ns.css,f=e+c,g=f;/^is[A-Z]/.test(b)?f=g=c:d!==e&&""!==d&&(g=d+c,f=e+c+" "+g),this.options.classesNs[b]=g,this.options.classes[b]=f},this))}};s.classes={wrapper:"",tab:"-tab",pane:"-pane",isActive:"is-active"},s.publicMethods=["destroy","prev","next","move"];var t={common:{body:a("body")},setup:function(){var b=f.call(this,"tab"),c=f.call(this,"pane");this.dom=this.dom||{},this.dom.el=a(this.element),this.dom.tab=this.dom.el.find(this.options.tab),this.dom.pane=this.dom.el.find(this.options.pane),this.dom.pane=this.dom.pane.length?this.dom.pane:t.common.body.find(this.options.pane),this.dom.el.addClass(this.options.classes.wrapper),this.dom.tab.addClass(this.options.classes.tab).attr({role:"tab","aria-selected":!1}).closest("li").attr({role:"presentation"}).closest("ul").attr({role:"tablist"}).end().end().each(b),this.dom.pane.addClass(this.options.classes.pane).attr({role:"tabpanel","aria-hidden":!0}).each(c),"accordion"===this.options.type&&(this.dom.pane.attr({"aria-expanded":!1}),this.options.multiSelect&&this.dom.el.attr({"aria-multiselectable":!0})),this.options.create.call(this.element)},destroy:function(){this.dom.el.removeClass(this.options.classes.wrapper).removeAttr("aria-multiselectable"),this.dom.tab.removeClass(this.options.classes.tab).removeAttr("role aria-selected aria-controls").closest("li").removeAttr("role").closest("ul").removeAttr("role"),this.dom.pane.removeClass(this.options.classes.pane).removeAttr("role aria-hidden aria-labelledby aria-expanded"),this.dom.tab.add(this.dom.pane).each(function(){var b=a(this);/^kist-/.test(b.attr("id"))&&b.removeAttr("id")})}},u={setup:function(){this.dom.el.on("click"+this.instance.ens,"."+this.options.classesNs.tab,a.proxy(function(b){b.preventDefault(),this.select(this.dom.tab.index(a(b.currentTarget)))},this))},destroy:function(){this.dom.el.off(this.instance.ens)}},v={id:0,setup:function(){this.instance=this.instance||{},this.instance.id=v.id++,this.instance.ens=s.ns.event+"."+this.instance.id},destroy:function(){delete a.data(this.element)[s.name]}},w="Modernizr"in b&&Modernizr.history;a.extend(l.prototype,{toggleItem:function(a,b,c){var d,e;d="tab"===c?"aria-selected":"aria-hidden",e=b?"addClass":"removeClass","pane"===c&&(b=!b),a[e](this.options.classes.isActive).attr(d,b)},select:function(a){this.activeTab=this.dom.tab.filter("."+this.options.classes.isActive),this.activePane=this.dom.pane.filter("."+this.options.classes.isActive),this.newTab=this.dom.tab.eq(a),this.newPane=this.dom.pane.eq(a),this.isAlreadyActive=j.call(this,this.newTab,this.newPane),this.options.changeURL&&this.newTab.is("a")&&w&&history.pushState({},"",this.newTab.attr("href"))},triggerAction:function(a){this.isAlreadyActive||(!this.activeTab.length&&!this.activePane.length||j.call(this,this.activeTab,this.activePane)||this.options.deselect.call(this.element,this.activeTab,this.activePane),this.options.select.call(this.element,this.newTab,this.newPane),this.current=a)},prev:function(){g.call(this,"prev")},next:function(){g.call(this,"next")},move:function(b){var c,d;"number"==typeof b&&this.select(b-1),"string"==typeof b&&(b=k(b),c=this.dom.tab.filter(a.proxy(i,null,b)),d=this.dom.pane.filter(a.proxy(h,null,b)),c.length?this.select(this.dom.tab.index(c[0])):d.length&&this.select(this.dom.pane.index(d[0])))},destroy:function(){t.destroy.call(this),u.destroy.call(this),v.destroy.call(this)},current:null,defaults:{type:"tab",initial:1,multiSelect:!1,tab:"> ul > li > a, > ul > li > button",pane:"> div > div",changeURL:!1,select:function(){},deselect:function(){},create:function(){},namespace:s.ns.css}}),n.prototype=l.prototype,m.prototype=new n,m.prototype.constructor=m,m._super=l.prototype,a.extend(m.prototype,{select:function(a){m._super.select.apply(this,arguments),this.toggleItem(this.dom.tab,!1,"tab"),this.toggleItem(this.dom.pane,!1,"pane"),this.toggleItem(this.newTab,!0,"tab"),this.toggleItem(this.newPane,!0,"pane"),this.triggerAction(a)}}),p.prototype=l.prototype,o.prototype=new p,o.prototype.constructor=o,o._super=l.prototype,a.extend(o.prototype,{toggleItem:function(a,b,c){o._super.toggleItem.apply(this,arguments),"pane"===c&&a.attr({"aria-expanded":b})},select:function(a){o._super.select.apply(this,arguments);var b=this.isAlreadyActive,c=this.options.multiSelect?"not":"filter";this.toggleItem(this.dom.tab[c](this.activeTab),!1,"tab"),this.toggleItem(this.dom.pane[c](this.activePane),!1,"pane"),this.toggleItem(this.newTab,!b,"tab"),this.toggleItem(this.newPane,!b,"pane"),this.triggerAction(a)},triggerAction:function(){o._super.triggerAction.apply(this,arguments),this.isAlreadyActive&&this.options.deselect.call(this.element,this.newTab,this.newPane)}}),a.kist=a.kist||{},a.kist[s.name]={defaults:l.prototype.defaults},a.fn[s.name]=function(b,c){if("string"==typeof b&&-1!==a.inArray(b,s.publicMethods))return this.each(function(){var e=a.data(this,s.name);e&&e[b]("move"===b?c:d)});b=q(b);var e=r(b);return this.each(function(){a.data(this,s.name)||a.data(this,s.name,new e(this,b))})}}(jQuery,window,document);